import{O as E,z as c,E as M,l as e,_ as X,I as Z,x as ee,aI as ae,aJ as oe,aN as te,aF as ne,n as B,aO as se,m as w,aL as ce,q as F,aM as N,aH as R,aP as le,aQ as ie}from"./index-QiXJX-Ca.js";import{B as L}from"./Button-fRwF3mYj.js";var re=E("Icon16Clear","clear_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" id="clear_16"><path fill-rule="evenodd" d="M16 8A8 8 0 1 0 0 8a8 8 0 0 0 16 0M4.563 4.564a.9.9 0 0 0 0 1.272L6.727 8l-2.164 2.164a.9.9 0 1 0 1.273 1.272L8 9.273l2.164 2.163a.9.9 0 0 0 1.272-1.272L9.273 8l2.163-2.164a.9.9 0 1 0-1.272-1.272L8 6.727 5.836 4.564a.9.9 0 0 0-1.273 0" clip-rule="evenodd" /></symbol>',16,16),ue=E("Icon16SearchOutline","search_outline_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="search_outline_16"><path fill="currentColor" d="M6.5 1a5.5 5.5 0 0 1 4.384 8.823l3.895 3.9a.75.75 0 0 1-1.061 1.06l-3.895-3.9A5.5 5.5 0 1 1 6.5 1m0 1.5a4 4 0 1 0 0 8 4 4 0 0 0 0-8" /></symbol>',16,16);const de=(l=!1)=>{const[t,n]=c.useState(l),p=c.useCallback(()=>{n(!0)},[]),u=c.useCallback(()=>{n(!1)},[]),d=c.useCallback(()=>{n(!t)},[t]);return{value:t,setTrue:p,setFalse:u,toggle:d}},ve=(l,t)=>{M(()=>{if(!l.current)return;const n=l.current.closest("form");if(n)return n.addEventListener("reset",t),()=>{n.removeEventListener("reset",t)}},[l,t])},fe=l=>{var{id:t,before:n=e.jsx(ue,{}),className:p,placeholder:u="Поиск",after:d="Отмена",getRef:P,icon:r,onIconClick:v,style:V,autoComplete:z="off",onChange:O,iconLabel:T,clearLabel:H="Очистить",noPadding:A,getRootRef:D,findButtonText:Y="Найти",onFindButtonClick:x}=l,o=X(l,["id","before","className","placeholder","after","getRef","icon","onIconClick","style","autoComplete","onChange","iconLabel","clearLabel","noPadding","getRootRef","findButtonText","onFindButtonClick"]);const i=Z(P),{value:q,setTrue:f,setFalse:m}=de(!1),J=c.useId(),C=t||`search-${J}`,[_,k]=c.useState(()=>!!(o.value||o.defaultValue)),Q=a=>k(!!a.currentTarget.value),{sizeY:S="none"}=ee(),{sizeY:I}=ae(),j=oe(),g=j==="ios"&&ne(d),$=a=>{f(),o.onFocus&&o.onFocus(a)},G=a=>{m(),o.onBlur&&o.onBlur(a)},h=c.useCallback(()=>{var a,s;const b=(a=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"))===null||a===void 0?void 0:a.set;b==null||b.call(i.current,"");const W=new Event("input",{bubbles:!0});(s=i.current)===null||s===void 0||s.dispatchEvent(W)},[i]),K=c.useCallback(a=>v==null?void 0:v(a),[v]),U=c.useCallback(a=>{var s;a.preventDefault(),(s=i.current)===null||s===void 0||s.focus(),te()&&h()},[i,h]);M(()=>{o.value!==void 0&&k(!!o.value)},[o.value]),ve(i,()=>{k(!!o.defaultValue)});const y=(a,s={})=>e.jsxs(N,w(F({hoverMode:"opacity",onPointerDown:K,className:"vkuiSearch__icon",onFocus:f,onBlur:m,onClick:ie},s),{children:[e.jsx(R,{children:T}),a]}));return e.jsxs("div",{className:B("vkuiInternalSearch","vkuiSearch",S==="none"&&"vkuiSearch--sizeY-none",S==="compact"&&"vkuiSearch--sizeY-compact",q&&"vkuiSearch--focused",_&&"vkuiSearch--has-value",g&&"vkuiSearch--has-after",r&&"vkuiSearch--has-icon",o.disabled&&"vkuiSearch--disabled",!A&&"vkuiSearch--withPadding",p),ref:D,style:V,children:[e.jsxs("div",{className:"vkuiSearch__field",children:[e.jsx("label",{htmlFor:C,className:"vkuiSearch__label",children:u}),e.jsxs("div",{className:"vkuiSearch__input",children:[n,e.jsx(se,w(F({Component:"input",type:"search",level:"1",weight:"3"},o),{id:C,placeholder:u,autoComplete:z,getRootRef:i,className:"vkuiSearch__nativeInput",onFocus:$,onBlur:G,onChange:ce(O,Q)}))]}),e.jsxs("div",{className:"vkuiSearch__controls",children:[r&&(typeof r=="function"?r(y):y(r)),e.jsxs(N,{hoverMode:"opacity",onPointerDown:U,onClick:h,className:"vkuiSearch__icon",tabIndex:_?void 0:-1,disabled:o.disabled,children:[e.jsx(R,{children:H}),j==="ios"?e.jsx(re,{}):e.jsx(le,{})]}),I.compact&&x&&e.jsx(L,{mode:"primary",size:"m",className:B("vkuiSearch__findButton",I.compact.className),focusVisibleMode:"inside",onClick:x,tabIndex:_?void 0:-1,children:Y})]})]}),g&&e.jsx("div",{className:"vkuiSearch__after",children:e.jsx(L,{mode:"tertiary",size:"m",focusVisibleMode:"inside",hoverMode:"opacity",activeMode:"opacity",onClick:h,onFocus:f,onBlur:m,children:e.jsx("span",{className:"vkuiSearch__afterTextClip",children:d})})})]})};export{fe as S};
