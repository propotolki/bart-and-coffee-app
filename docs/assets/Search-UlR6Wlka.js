import{r as c,j as e,a as X,u as Z,h as ee,c as B,b as w,d as F}from"./Typography-Byh9fUcv.js";import{u as M,K as oe,L as ae,V as N,M as te}from"./VisuallyHidden-8Hixhu_K.js";import{u as ne}from"./useExternRef-BpbbNXQC.js";import{m as E,B as R}from"./Button-MhB0ftXQ.js";import{I as L,a as se}from"./Removable-BevrVg9y.js";import{H as ce}from"./Headline-BNzsiov9.js";import{a as le,t as re}from"./Cell-ByABXtIu.js";var ie=E("Icon16Clear","clear_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" id="clear_16"><path fill-rule="evenodd" d="M16 8A8 8 0 1 0 0 8a8 8 0 0 0 16 0M4.563 4.564a.9.9 0 0 0 0 1.272L6.727 8l-2.164 2.164a.9.9 0 1 0 1.273 1.272L8 9.273l2.164 2.163a.9.9 0 0 0 1.272-1.272L9.273 8l2.163-2.164a.9.9 0 1 0-1.272-1.272L8 6.727 5.836 4.564a.9.9 0 0 0-1.273 0" clip-rule="evenodd" /></symbol>',16,16),ue=E("Icon16SearchOutline","search_outline_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="search_outline_16"><path fill="currentColor" d="M6.5 1a5.5 5.5 0 0 1 4.384 8.823l3.895 3.9a.75.75 0 0 1-1.061 1.06l-3.895-3.9A5.5 5.5 0 1 1 6.5 1m0 1.5a4 4 0 1 0 0 8 4 4 0 0 0 0-8" /></symbol>',16,16);const de=(l=!1)=>{const[t,n]=c.useState(l),h=c.useCallback(()=>{n(!0)},[]),u=c.useCallback(()=>{n(!1)},[]),d=c.useCallback(()=>{n(!t)},[t]);return{value:t,setTrue:h,setFalse:u,toggle:d}},ve=(l,t)=>{M(()=>{if(!l.current)return;const n=l.current.closest("form");if(n)return n.addEventListener("reset",t),()=>{n.removeEventListener("reset",t)}},[l,t])},xe=l=>{var{id:t,before:n=e.jsx(ue,{}),className:h,placeholder:u="Поиск",after:d="Отмена",getRef:P,icon:i,onIconClick:v,style:V,autoComplete:T="off",onChange:z,iconLabel:H,clearLabel:O="Очистить",noPadding:A,getRootRef:D,findButtonText:Y="Найти",onFindButtonClick:x}=l,a=X(l,["id","before","className","placeholder","after","getRef","icon","onIconClick","style","autoComplete","onChange","iconLabel","clearLabel","noPadding","getRootRef","findButtonText","onFindButtonClick"]);const r=ne(P),{value:K,setTrue:m,setFalse:f}=de(!1),$=c.useId(),C=t||`search-${$}`,[_,k]=c.useState(()=>!!(a.value||a.defaultValue)),q=o=>k(!!o.currentTarget.value),{sizeY:S="none"}=Z(),{sizeY:j}=le(),I=oe(),g=I==="ios"&&ee(d),G=o=>{m(),a.onFocus&&a.onFocus(o)},J=o=>{f(),a.onBlur&&a.onBlur(o)},p=c.useCallback(()=>{var o,s;const b=(o=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"))===null||o===void 0?void 0:o.set;b==null||b.call(r.current,"");const W=new Event("input",{bubbles:!0});(s=r.current)===null||s===void 0||s.dispatchEvent(W)},[r]),Q=c.useCallback(o=>v==null?void 0:v(o),[v]),U=c.useCallback(o=>{var s;o.preventDefault(),(s=r.current)===null||s===void 0||s.focus(),re()&&p()},[r,p]);M(()=>{a.value!==void 0&&k(!!a.value)},[a.value]),ve(r,()=>{k(!!a.defaultValue)});const y=(o,s={})=>e.jsxs(L,w(F({hoverMode:"opacity",onPointerDown:Q,className:"vkuiSearch__icon",onFocus:m,onBlur:f,onClick:te},s),{children:[e.jsx(N,{children:H}),o]}));return e.jsxs("div",{className:B("vkuiInternalSearch","vkuiSearch",S==="none"&&"vkuiSearch--sizeY-none",S==="compact"&&"vkuiSearch--sizeY-compact",K&&"vkuiSearch--focused",_&&"vkuiSearch--has-value",g&&"vkuiSearch--has-after",i&&"vkuiSearch--has-icon",a.disabled&&"vkuiSearch--disabled",!A&&"vkuiSearch--withPadding",h),ref:D,style:V,children:[e.jsxs("div",{className:"vkuiSearch__field",children:[e.jsx("label",{htmlFor:C,className:"vkuiSearch__label",children:u}),e.jsxs("div",{className:"vkuiSearch__input",children:[n,e.jsx(ce,w(F({Component:"input",type:"search",level:"1",weight:"3"},a),{id:C,placeholder:u,autoComplete:T,getRootRef:r,className:"vkuiSearch__nativeInput",onFocus:G,onBlur:J,onChange:ae(z,q)}))]}),e.jsxs("div",{className:"vkuiSearch__controls",children:[i&&(typeof i=="function"?i(y):y(i)),e.jsxs(L,{hoverMode:"opacity",onPointerDown:U,onClick:p,className:"vkuiSearch__icon",tabIndex:_?void 0:-1,disabled:a.disabled,children:[e.jsx(N,{children:O}),I==="ios"?e.jsx(ie,{}):e.jsx(se,{})]}),j.compact&&x&&e.jsx(R,{mode:"primary",size:"m",className:B("vkuiSearch__findButton",j.compact.className),focusVisibleMode:"inside",onClick:x,tabIndex:_?void 0:-1,children:Y})]})]}),g&&e.jsx("div",{className:"vkuiSearch__after",children:e.jsx(R,{mode:"tertiary",size:"m",focusVisibleMode:"inside",hoverMode:"opacity",activeMode:"opacity",onClick:p,onFocus:m,onBlur:f,children:e.jsx("span",{className:"vkuiSearch__afterTextClip",children:d})})})]})};export{xe as S};
